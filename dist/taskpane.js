!function(){"use strict";var e={};function n(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=r(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,s=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return s=e.done,e},e:function(e){i=!0,c=e},f:function(){try{s||null==t.return||t.return()}finally{if(i)throw c}}}}function t(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,n){if(e){if("string"==typeof e)return a(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,n):void 0}}function a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function o(e,n,t,r,a,o,c){try{var s=e[o](c),i=s.value}catch(e){return void t(e)}s.done?n(i):Promise.resolve(i).then(r,a)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var c=e.apply(n,t);function s(e){o(c,r,a,s,i,"next",e)}function i(e){o(c,r,a,s,i,"throw",e)}s(void 0)}))}}e.d=function(n,t){for(var r in t)e.o(t,r)&&!e.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},e.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)};var s="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=["Name (incl. titles)","Affiliation/Organisation and location","Role","Email","Session Name","Session Description","Presentation Title","Presentation Abstract","Abstract URL","Video URL"],u=["director","department","team","group","consortium","project","university","institution","program","organization","research","network","international","medical","center","application","organisation","on behalf","study","genetic","medicine","topmed","genom","board","institute","science","college","accociat","global","develop","health","workplace","workspace","grupo","committee","hospital","student","associat","clinic","service","society","social","collaborat","national","working","contribut","surgery","covid","candidate","scient","non role","question","answer","unknown","author","invest","general","panel","discus","graduat","mr.","mrs.","ms.","technical","leader","senior","other"],l=["moderator","speaker","poster presenter","panelist","keynote speaker","invited speaker","abstract author"],p='<div class="loader" style="--b: 10px; --c:gray; width:50px; --n:20; --g:7deg"></div>',d='<div class="loader" style="--b: 6px; --c:gray; width:30px; --n:13; --g:7deg"></div>',m=function(e){return String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)};function f(e){var n;try{n=new URL(e)}catch(e){return!1}return"http:"===n.protocol||"https:"===n.protocol}function g(){return h.apply(this,arguments)}function h(){return h=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(n){var t,r,a,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("app-welcome").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("loader").style.display="flex",t=n.workbook.worksheets.getActiveWorksheet(),(r=t.getUsedRange()).load("rowCount, columnCount, values"),e.next=8,n.sync();case 8:if(a=r.values,o=r.rowCount,c=r.columnCount,null!==a){e.next=15;break}return document.getElementById("loader").style.display="none",document.getElementById("null-body").style.display="flex",e.abrupt("return");case 15:return e.next=17,x(a);case 17:return e.next=19,k(c,o);case 19:return e.next=21,E(a,o);case 21:return e.next=23,I(a,o);case 23:return e.next=25,T(a,o);case 25:return e.next=27,M(a,o);case 27:return e.next=29,A(a,o);case 29:return e.next=31,N(a,o);case 31:return e.next=33,j(a,o);case 33:return e.next=35,U(a,o);case 35:return e.next=37,O(a,o);case 37:return e.next=39,_(a,o);case 39:"none"===document.getElementById("errors-msg").style.display&&(document.getElementById("loader").style.display="none",document.getElementById("no-errors-msg").style.display="inline-grid");case 40:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),h.apply(this,arguments)}function v(){return y.apply(this,arguments)}function y(){return y=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("errors-msg").style.display="none",document.getElementById("warning-msg").style.display="none",document.getElementById("no-errors-msg").style.display="none",document.getElementById("header-errors").innerHTML="",document.getElementById("data-range-errors").innerHTML="",document.getElementById("author-name-errors").innerHTML="",document.getElementById("author-role-errors").innerHTML="",document.getElementById("author-email-errors").innerHTML="",document.getElementById("session-names-errors").innerHTML="",document.getElementById("title-errors").innerHTML="",document.getElementById("url-errors").innerHTML="",document.getElementById("poster_session_errors").innerHTML="",document.getElementById("duplicate-errors").innerHTML="",document.getElementById("author-name-warnings").innerHTML="",document.getElementById("url-warnings").innerHTML="",document.getElementById("title-warnings").innerHTML="",document.getElementById("several-main-role-warnings").innerHTML="",e.next=19,g();case 19:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),y.apply(this,arguments)}function x(e){return w.apply(this,arguments)}function w(){return w=c(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(t){var r,a,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("header-errors").innerHTML=p,r=n[0],a=[],o=0;o<10;o++)r[o]!==i[o]&&(c="".concat(s[o],"1"),a.push([c,'Header must be "'.concat(i[o],'"')]));if(document.getElementById("header-errors").innerHTML="",!(a.length>0)){e.next=11;break}return e.next=8,Q("header-errors","HEADERS",a);case 8:document.getElementById("header-errors").getElementsByClassName("card")[0].innerHTML+='<div class="accept-button-container">\n                             <span role="button" id="set-headers" class="accept-button">Set Right Headers</span>\n                           </div>',document.getElementById("set-headers").onclick=V;case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),w.apply(this,arguments)}function k(e,n){return b.apply(this,arguments)}function b(){return b=c(regeneratorRuntime.mark((function e(n,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(r){var a,o,c,i,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.getElementById("data-range-errors").innerHTML=p,a=r.workbook.worksheets.getActiveWorksheet(),o=[],!(n>10)){e.next=13;break}return(c=a.getRange("K1:".concat(s[n-1]).concat(t))).load("values"),console.log("loading"),e.next=9,r.sync();case 9:for(console.log(c.values),i=c.values,u=0;u<i.length;u++)for(l=0;l<i[u].length;l++)""!==i[u][l]&&o.push(["".concat(s[l+10]).concat(u+1),"Data out of operating range"]);console.log(o);case 13:if(document.getElementById("data-range-errors").innerHTML="",!(o.length>0)){e.next=20;break}return e.next=17,Q("data-range-errors","RANGE",o);case 17:document.getElementById("data-range-errors").getElementsByClassName("card")[0].innerHTML+='<div class="accept-button-container">\n                             <span role="button" id="clear-range" class="accept-button">Clear all</span>\n                           </div>',document.getElementById("clear-range").onclick=X;case 20:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),b.apply(this,arguments)}function E(e,n){return R.apply(this,arguments)}function R(){return R=c(regeneratorRuntime.mark((function e(n,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(r){var a,o,c,s,i,l,d,m,f,g,h,v,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.getElementById("author-name-errors").innerHTML=p,document.getElementById("author-name-warnings").innerHTML=p,a=0,o=/\d+/gm,c=["{","}","(",")","[","]","!","?","/","|","~","*","&","#","$","%","^","=","+","<",">","@"],s=[],i=[],l=1;case 8:if(!(l<t)){e.next=51;break}for(d="A".concat(l+1),m=n[l],f=m[a].toString().trim(),g=[],h=0;h<c.length;h++)f.includes(c[h])&&g.push(c[h]);if(null===o.exec(f)){e.next=18;break}s.push([d,'Author name "'.concat(f,'" contains a number')]),e.next=47;break;case 18:if(""!==f){e.next=22;break}s.push([d,"Author name is empty"]),e.next=47;break;case 22:if(f.includes(" ")){e.next=26;break}s.push([d,'Author name "'.concat(f,"\" doesn't contain spaces")]),e.next=47;break;case 26:if(!(f.length<5)){e.next=30;break}s.push([d,'Author name "'.concat(f,'" is too short')]),e.next=47;break;case 30:if(!(f.length>50)){e.next=34;break}s.push([d,"Author name is too long"]),e.next=47;break;case 34:if(!(g.length>0)){e.next=38;break}s.push([d,'Author name "'.concat(f,'" contains unexpected characters: ').concat(g.join(" "))]),e.next=47;break;case 38:v=f.toLowerCase(),y=0;case 40:if(!(y<u.length)){e.next=47;break}if(!v.includes(u[y])){e.next=44;break}return s.push([d,'Author name "'.concat(f,'" contains a word from a blacklist: "').concat(u[y],'"')]),e.abrupt("break",47);case 44:y++,e.next=40;break;case 47:f.charAt(0)!==f.charAt(0).toUpperCase()&&i.push([d,'Author name "'.concat(f,"\" doesn't begin with a capital letter")]);case 48:l++,e.next=8;break;case 51:if(document.getElementById("author-name-errors").innerHTML="",document.getElementById("author-name-warnings").innerHTML="",!(s.length>0)){e.next=56;break}return e.next=56,Q("author-name-errors","AUTHORS",s);case 56:if(!(i.length>0)){e.next=59;break}return e.next=59,oe("author-name-warnings","AUTHORS",i);case 59:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),R.apply(this,arguments)}function I(e,n){return L.apply(this,arguments)}function L(){return L=c(regeneratorRuntime.mark((function e(n,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(r){var a,o,c,s,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("author-role-errors").innerHTML=p,a=[],o=1;o<t;o++)c="C".concat(o+1),s=n[o],i=s[2].toString().trim(),u=i.toLowerCase(),""===i?a.push([c,"Author role is empty"]):l.includes(u)||a.push([c,'Author role "'.concat(i,'" is invalid')]);if(document.getElementById("author-role-errors").innerHTML="",!(a.length>0)){e.next=8;break}return e.next=8,Q("author-role-errors","ROLES",a);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),L.apply(this,arguments)}function T(e,n){return B.apply(this,arguments)}function B(){return B=c(regeneratorRuntime.mark((function e(n,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(r){var a,o,c,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("author-email-errors").innerHTML=p,a=[],o=1;o<t;o++)c="D".concat(o+1),s=n[o],""!==(i=s[3].toString().trim())&&(m(i)||a.push([c,'Author email "'.concat(i,'" is invalid')]));if(document.getElementById("author-email-errors").innerHTML="",!(a.length>0)){e.next=8;break}return e.next=8,Q("author-email-errors","EMAILS",a);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),B.apply(this,arguments)}function M(e,n){return H.apply(this,arguments)}function H(){return H=c(regeneratorRuntime.mark((function e(n,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(r){var a,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("session-names-errors").innerHTML=p,a=[],o=1;o<t;o++)c="E".concat(o+1),""===n[o][4].toString().trim()&&a.push([c,"Session name is empty"]);if(document.getElementById("session-names-errors").innerHTML="",!(a.length>0)){e.next=8;break}return e.next=8,Q("session-names-errors","SESSION",a);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),H.apply(this,arguments)}function A(e,n){return S.apply(this,arguments)}function S(){return S=c(regeneratorRuntime.mark((function e(n,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(r){var a,o,c,s,i,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("title-errors").innerHTML=p,document.getElementById("title-warnings").innerHTML=p,a=[],o=[],c=1;c<t;c++)s="G".concat(c+1),i=n[c],u=i[2].toString().trim(),l=i[6].toString().trim(),"Moderator"!==u&&""===l?(a.push([s,"Presentation title is empty"]),console.warn("Presentation title is empty in row ".concat(c+1))):"Moderator"!==u&&l.length<=5?o.push([s,"Presentation title is too short"]):"Moderator"===u&&""!==l&&a.push([s,"Presentation title should be empty (Moderator)"]);if(document.getElementById("title-errors").innerHTML="",!(a.length>0)){e.next=11;break}return e.next=11,Q("title-errors","TITLE",a);case 11:if(document.getElementById("title-warnings").innerHTML="",!(o.length>0)){e.next=15;break}return e.next=15,oe("title-warnings","TITLE",o);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),S.apply(this,arguments)}function N(e,n){return C.apply(this,arguments)}function C(){return C=c(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(a){var o,c,s,i,u,l,d,m,g,h,v,y,x,w,k,b,E;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("url-errors").innerHTML=p,document.getElementById("url-warnings").innerHTML=p,o=[],c=[],s=1;s<r;s++){i="I".concat(s+1),u="J".concat(s+1),l=t[s],d=l[2].toString().trim(),m=l[8].toString().trim(),[],h=l[9].toString().trim(),[],g=m.includes("||")?m.split("||"):[m],console.log(g),v=h.includes("||")?h.split("||"):[h],console.log(v),y=n(g);try{for(y.s();!(x=y.n()).done;)w=x.value,"Moderator"!==d?""===w?o.push([i,"Presentation URL is empty"]):f(w)?w.includes("github")&&o.push([i,"Presentation URL leads to the github PDF viewer"]):o.push([i,'<span class="title-decoration" title="'.concat(w,'">Presentation URL</span> is invalid')]):"Moderator"===d&&""!==w&&(f(w)||o.push([i,'<span class="title-decoration" title="'.concat(w,'">Presentation URL</span> is invalid')]),c.push([i,"Double check if the moderator needs the URL"]))}catch(e){y.e(e)}finally{y.f()}k=n(v);try{for(k.s();!(b=k.n()).done;)E=b.value,"Moderator"!==d&&""!==E?f(E)||o.push([u,'<span class="title-decoration" title="'.concat(E,'">Video URL</span> is invalid')]):"Moderator"===d&&""!==E&&o.push([u,"Video URL must be empty for Moderator"])}catch(e){k.e(e)}finally{k.f()}}if(document.getElementById("url-errors").innerHTML="",!(o.length>0)){e.next=12;break}return e.next=12,Q("url-errors","URL",o);case 12:if(document.getElementById("url-warnings").innerHTML="",!(c.length>0)){e.next=16;break}return e.next=16,oe("url-warnings","URL",c);case 16:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),C.apply(this,arguments)}function O(e,n){return P.apply(this,arguments)}function P(){return P=c(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(a){var o,c,s,i,u,l,d,m,f,g,h,v,y,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("duplicate-errors").innerHTML=p,o=a.workbook.worksheets.getActiveWorksheet(),c=r,o.getRange("X2").formulas=[["=CONCATENATE(A2:A".concat(c,", B2:B").concat(c,", C2:C").concat(c,", E2:E").concat(c,", G2:G").concat(c,")")]],e.next=7,a.sync();case 7:return(s=o.getRange("X2:X".concat(c))).load("values"),e.next=11,a.sync();case 11:for(i=s.values.flat(),u=i.getDuplicates(),l=Object.keys(u),d=[],m=0,f=l;m<f.length;m++){g=f[m],h=[],v=n(u[g]);try{for(v.s();!(y=v.n()).done;)x=y.value,h.push(["A".concat(x+2),"".concat(t[x+1][0]," | ").concat(t[x+1][2])])}catch(e){v.e(e)}finally{v.f()}h.length>1&&d.push(h)}return s.clear(),e.next=19,a.sync();case 19:if(document.getElementById("duplicate-errors").innerHTML="",!(d.length>0)){e.next=27;break}return e.next=23,ne("duplicate-errors","DUPLICATE",d);case 23:document.getElementById("duplicate-errors").getElementsByClassName("card")[0].innerHTML+='<div class="accept-button-container">\n                             <span role="button"\n                             id="remove-full-duplicates"\n                             class="accept-button"\n                             title="Removes fully matched rows">Remove full duplicates\n                             <i class="ms-Icon ms-Icon--Warning ms-font-xxl" title="This action cannot be undone via Ctrl+Z"></i>\n                             </span>\n                           </div>\n                           <div class="accept-button-container">\n                             <span \n                             role="button" \n                             id="remove-presented-duplicates" \n                             class="accept-button" \n                             title="Removes rows that are matched by:\nName (incl. titles)\nAffiliation/Organisation and location\nRole\nSession Name\nPresentation Title">Remove presented duplicates\n                             <i class="ms-Icon ms-Icon--Warning ms-font-xxl" title="This action cannot be undone via Ctrl+Z"></i>\n                             </span>\n                           </div>',document.getElementById("remove-full-duplicates").onclick=J,document.getElementById("remove-presented-duplicates").onclick=F;case 27:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),P.apply(this,arguments)}function U(e,n){return W.apply(this,arguments)}function W(){return W=c(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(a){var o,c,s,i,u,l,d,m,f,g,h,v,y,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("several-main-role-warnings").innerHTML=p,o=a.workbook.worksheets.getActiveWorksheet(),(c=o.getRange("G2:G".concat(r))).load("values"),e.next=6,a.sync();case 6:for(s=c.values.flat(),i=s.getDuplicates(),u=Object.keys(i),l=["Poster Presenter","Speaker","Invited Speaker","Keynote Speaker"],d=[],m=0,f=u;m<f.length;m++){g=f[m],h=[],v=n(i[g]);try{for(v.s();!(y=v.n()).done;)x=y.value,l.includes(t[x+1][2])&&h.push(["A".concat(x+2),"".concat(t[x+1][0]," | ").concat(t[x+1][2])])}catch(e){v.e(e)}finally{v.f()}h.length>1&&d.push(h)}if(document.getElementById("several-main-role-warnings").innerHTML="",!(d.length>0)){e.next=16;break}return e.next=16,re("several-main-role-warnings","SEVERAL MAIN ROLES BY PRESENTATION",d);case 16:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),W.apply(this,arguments)}function j(e,n){return G.apply(this,arguments)}function G(){return G=c(regeneratorRuntime.mark((function e(n,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(r){var a,o,c,s,i,u,l,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("poster_session_errors").innerHTML=p,a=["speaker","invited speaker","keynote speaker"],console.log("Starting test_poster_sessions"),o=new Set,c=1;c<t;c++)"Poster Presenter"===n[c][2]&&o.add(n[c][4]);for(console.log(o),s=[],i=1;i<t;i++)u="A".concat(i+1),l=n[i],d=l[2].toString().trim(),m=l[4].toString().trim(),o.has(m)&&a.includes(d.toLowerCase())&&s.push([u,"".concat(d," in a poster session")]);if(document.getElementById("poster_session_errors").innerHTML="",!(s.length>0)){e.next=14;break}return e.next=14,Q("poster_session_errors","WRONG ROLE IN POSTER SESSION",s);case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),G.apply(this,arguments)}function _(e,n){return D.apply(this,arguments)}function D(){return D=c(regeneratorRuntime.mark((function e(r,a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(o){var c,i,u,l,d,m,f,g,h,v,y,x,w,k,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("html-errors").innerHTML=p,c=[],i=1;i<a;i++)for(u=r[i],l=0;l<u.length;l++){d="".concat(s[l]).concat(i+1),(m=document.createElement("div")).innerHTML=u[l],(f=t(m.querySelectorAll("*")).filter((function(e){return"[object HTMLUnknownElement]"!==Object.prototype.toString.call(e)}))).length>0&&(g=f.map((function(e){return"&lt;".concat(e.tagName.toLowerCase(),"&gt;")})),g=Array.from(new Set(g)),c.push([d,"There are HTML tags: <code>".concat(g,"</code>")])),h=/&.+?;/gm,v=t(u[l].toString().matchAll(h)),y=[],x=n(v);try{for(x.s();!(w=x.n()).done;)k=w.value,y.includes(k[0])||k[0]===ie(k[0])||y.push(k[0])}catch(e){x.e(e)}finally{x.f()}y.length>0&&(b=y.map((function(e){return se(e)})),c.push([d,"There are HTML entities: <code>".concat(b,"</code>")]),console.log(c))}if(document.getElementById("html-errors").innerHTML="",!(c.length>0)){e.next=7;break}return e.next=7,Q("html-errors","HTML",c);case 7:document.getElementById("html-errors").getElementsByClassName("card")[0].innerHTML+='<div class="accept-button-container">\n                             <span role="button"\n                             id="remove-html"\n                             class="accept-button"\n                             title="Removes tags and html entities">Remove HTML elements\n                             <i class="ms-Icon ms-Icon--Warning ms-font-xxl" title="This action cannot be undone via Ctrl+Z"></i>\n                             </span>\n                           </div>',document.getElementById("remove-html").onclick=q;case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),D.apply(this,arguments)}function q(){return Z.apply(this,arguments)}function Z(){return Z=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(n){var t,r,a,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("remove-html").innerHTML=d,t=n.workbook.worksheets.getActiveWorksheet(),(r=t.getUsedRange()).load("values"),e.next=6,n.sync();case 6:for(a=r.values,o=0;o<a.length;o++)for(c=0;c<a[o].length;c++)a[o][c]=ue(a[o][c]);return r.values=a,r.format.rowHeight=15,e.next=12,n.sync();case 12:document.getElementById("html-errors").innerHTML="";case 13:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),Z.apply(this,arguments)}function V(){return K.apply(this,arguments)}function K(){return K=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.workbook.worksheets.getActiveWorksheet().getRange("A1:J1").values=[i],e.next=5,n.sync();case 5:document.getElementById("header-errors").innerHTML="";case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),K.apply(this,arguments)}function X(){return z.apply(this,arguments)}function z(){return z=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.workbook.worksheets.getActiveWorksheet().getRange("K:Z").clear(),e.next=5,n.sync();case 5:return e.next=7,k();case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),z.apply(this,arguments)}function J(){return $.apply(this,arguments)}function $(){return $=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(n){var t,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("In it"),t=n.workbook.worksheets.getActiveWorksheet(),r=t.getUsedRange(),(a=r.removeDuplicates([0,1,2,3,4,5,6,7,8,9],!0)).load(),e.next=7,n.sync();case 7:return console.log(a.removed+" entries with duplicate names removed."),console.log(a.uniqueRemaining+" entries with unique names remain in the range."),e.next=11,v();case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),$.apply(this,arguments)}function F(){return Y.apply(this,arguments)}function Y(){return Y=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(n){var t,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.workbook.worksheets.getActiveWorksheet(),r=t.getUsedRange(),(a=r.removeDuplicates([0,1,2,4,6],!0)).load(),e.next=6,n.sync();case 6:return console.log(a.removed+" entries with duplicate names removed."),console.log(a.uniqueRemaining+" entries with unique names remain in the range."),e.next=10,v();case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),Y.apply(this,arguments)}function Q(e,n,t){return ee.apply(this,arguments)}function ee(){return ee=c(regeneratorRuntime.mark((function e(n,t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(a){var o,c,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("errors-msg").style.display="inline-grid",document.getElementById("loader").style.display="none",(o=document.getElementById(n)).style.display="block",o.innerHTML='<div class="card">\n                          <div class="card-label">'.concat(t,'\n                          <sup class="error-label" title="Need to fix">ERROR</sup></div>\n                          <div class="card-container"></div>'),c=o.getElementsByClassName("card-container")[0],s=0;s<r.length;s++)i="set_active('".concat(r[s][0],"')"),console.log(i),c.innerHTML+='<div class="container-row">\n                                       <div class="goto-cell-button" \n                                       onclick="'.concat(i,'" \n                                       title="Go to cell">').concat(r[s][0],'</div>\n                                       <div class="row-explanation">').concat(r[s][1],"</div>\n                                     </div>");return o.innerHTML+="</div></div>",e.next=10,a.sync();case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),ee.apply(this,arguments)}function ne(e,n,t){return te.apply(this,arguments)}function te(){return te=c(regeneratorRuntime.mark((function e(n,t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(a){var o,c,s,i,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("errors-msg").style.display="inline-grid",document.getElementById("loader").style.display="none",(o=document.getElementById(n)).style.display="block",o.innerHTML='<div class="card">\n                          <div class="card-label">'.concat(t,'\n                          <sup class="error-label" title="Need to fix">ERROR</sup></div>\n                          ').concat('<div class="card-container"></div>'.repeat(r.length)),c=0;c<r.length;c++)for(s=o.getElementsByClassName("card-container")[c],i=0;i<r[c].length;i++)u=0===i?"":'<div class="duplicate"></div>',l="set_active('".concat(r[c][i][0],"')"),s.innerHTML+='<div class="container-row">\n                                         '.concat(u,'\n                                         <div class="goto-cell-button" \n                                         onclick="').concat(l,'" \n                                         title="Go to cell">').concat(r[c][i][0],'</div>\n                                         <div class="row-explanation duplicates">').concat(r[c][i][1],"</div>\n                                       </div>");return o.innerHTML+="</div></div>",e.next=10,a.sync();case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),te.apply(this,arguments)}function re(e,n,t){return ae.apply(this,arguments)}function ae(){return ae=c(regeneratorRuntime.mark((function e(n,t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(a){var o,c,s,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("warning-msg").style.display="inline-grid",document.getElementById("loader").style.display="none",(o=document.getElementById(n)).style.display="block",o.innerHTML='<div class="card">\n                          <div class="card-label">'.concat(t,'\n                          <sup class="warning-label" title="Need to double-check">WARNING</sup></div>\n                          ').concat('<div class="card-container"></div>'.repeat(r.length)),c=0;c<r.length;c++)for(s=o.getElementsByClassName("card-container")[c],i=0;i<r[c].length;i++)u="set_active('".concat(r[c][i][0],"')"),s.innerHTML+='<div class="container-row">\n                                         <div class="goto-cell-button" \n                                         onclick="'.concat(u,'" \n                                         title="Go to cell">').concat(r[c][i][0],'</div>\n                                         <div class="row-explanation duplicates">').concat(r[c][i][1],"</div>\n                                       </div>");return o.innerHTML+="</div></div>",e.next=10,a.sync();case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),ae.apply(this,arguments)}function oe(e,n,t){return ce.apply(this,arguments)}function ce(){return ce=c(regeneratorRuntime.mark((function e(n,t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=c(regeneratorRuntime.mark((function e(a){var o,c,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(document.getElementById("warning-msg").style.display="inline-grid",document.getElementById("loader").style.display="none",(o=document.getElementById(n)).style.display="block",o.innerHTML='<div class="card">\n                          <div class="card-label">'.concat(t,'\n                          <sup class="warning-label" title="Need to double-check">WARNING</sup></div>\n                          <div class="card-container"></div>'),c=o.getElementsByClassName("card-container")[0],s=0;s<r.length;s++)i="set_active('".concat(r[s][0],"')"),console.log(i),c.innerHTML+='<div class="container-row">\n                                       <div class="goto-cell-button" onclick="'.concat(i,'" title="Go to cell">').concat(r[s][0],'</div>\n                                       <div class="row-explanation">').concat(r[s][1],"</div>\n                                     </div>");return o.innerHTML+="</div></div>",e.next=10,a.sync();case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),ce.apply(this,arguments)}function se(e){var n=document.createElement("textarea");return n.textContent=e,n.innerHTML}function ie(e){var n=document.createElement("textarea");return n.innerHTML=e,n.textContent}function ue(e){var r=ie(e),a=document.createElement("div");a.innerHTML=r;var o=t(a.querySelectorAll("*")).filter((function(e){return"[object HTMLUnknownElement]"===Object.prototype.toString.call(e)}));if(o.length>0){var c,s=n(o);try{for(s.s();!(c=s.n()).done;){var i=c.value,u=new RegExp("(?<=<)(?=".concat(i.tagName,")"),"gmi");r=r.replace(u," ")}}catch(e){s.e(e)}finally{s.f()}}return a.innerHTML=r,a.innerText}Array.prototype.getDuplicates=function(){for(var e={},n=0;n<this.length;n++)e.hasOwnProperty(this[n])?e[this[n]].push(n):this.lastIndexOf(this[n])!==n&&(e[this[n]]=[n]);return e},Office.onReady((function(e){e.host===Office.HostType.Excel&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-welcome").style.display="flex",document.getElementById("run").onclick=g,document.getElementById("refresh").onclick=v,document.getElementById("refresh2").onclick=v)}))}();
//# sourceMappingURL=taskpane.js.map